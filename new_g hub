local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- 创建主GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "VersionSelector"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

-- 创建居中显示的图片（尺寸设置为500x500）
local CenterImage = Instance.new("ImageLabel")
CenterImage.Name = "CenterImage"
CenterImage.AnchorPoint = Vector2.new(0.5, 0.5) -- 中心锚点
CenterImage.Size = UDim2.new(0, 500, 0, 500) -- 固定尺寸500x500
CenterImage.Position = UDim2.new(0.5, 0, 0.5, 0) -- 屏幕中心
CenterImage.BackgroundColor3 = Color3.new(0, 0, 0)
CenterImage.BackgroundTransparency = 1
CenterImage.ImageTransparency = 1
CenterImage.Visible = false
CenterImage.Image = "rbxassetid://126250274908480" -- 使用指定的图片ID
CenterImage.ZIndex = 2
CenterImage.Parent = ScreenGui

-- 背景蒙版
local Background = Instance.new("Frame")
Background.Name = "Background"
Background.Size = UDim2.new(1, 0, 1, 0)
Background.BackgroundColor3 = Color3.new(0, 0, 0)
Background.BackgroundTransparency = 1 -- 初始完全透明
Background.Visible = false
Background.ZIndex = 1
Background.Parent = ScreenGui

-- 渐变函数
local function fadeIn(object, duration, properties)
    object.Visible = true
    local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    return tween
end

local function fadeOut(object, duration, properties)
    local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    
    local completed = Instance.new("BindableEvent")
    tween.Completed:Connect(function()
        completed:Fire()
    end)
    
    return completed.Event
end

-- 显示中央大图
local function showCenterImage()
    -- 淡入背景蒙版（稍暗的覆盖）
    Background.Visible = true
    fadeIn(Background, 0.5, {BackgroundTransparency = 0.7})
    
    -- 淡入中央图片（从70%放大到100%，同时淡入）
    CenterImage.Visible = true
    
    local startSize = UDim2.new(0, 350, 0, 350) -- 从350x350开始
    CenterImage.Size = startSize
    
    local sizeTween = TweenService:Create(CenterImage, 
        TweenInfo.new(0.7, Enum.EasingStyle.Back, Enum.EasingDirection.Out), 
        {Size = UDim2.new(0, 500, 0, 500)})
    
    local fadeTween = TweenService:Create(CenterImage, 
        TweenInfo.new(0.7), 
        {ImageTransparency = 0})
    
    sizeTween:Play()
    fadeTween:Play()
    
    return sizeTween
end

-- 渐变动画
task.spawn(function()
    -- 显示中央大图（带动画效果）
    local imageTween = showCenterImage()
    imageTween.Completed:Wait()
    
    task.wait(3) -- 显示3秒
    
    -- 淡出中央图片（带缩小效果）
    local sizeTween = fadeOut(CenterImage, 0.7, {
        Size = UDim2.new(0, 350, 0, 350),
        ImageTransparency = 1
    })
    
    sizeTween:Wait()
    
    -- 淡出背景蒙版
    fadeOut(Background, 0.5, {BackgroundTransparency = 1}):Wait()
    
    -- 显示版本选择窗口
    createVersionWindow()
end)

function createVersionWindow()
    -- 确保背景存在
    Background.Visible = true
    Background.BackgroundTransparency = 0.7
    
    -- 主窗口
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    MainFrame.Size = UDim2.new(0.35, 0, 0.3, 0)
    MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 46)
    MainFrame.BackgroundTransparency = 0.15
    MainFrame.Visible = true
    MainFrame.ZIndex = 3
    
    -- 圆角优化
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0.05, 0)
    UICorner.Parent = MainFrame
    
    -- 窗口发光效果
    local Glow = Instance.new("UIStroke")
    Glow.Color = Color3.fromRGB(100, 100, 200)
    Glow.Thickness = 3
    Glow.Transparency = 0.7
    Glow.Enabled = true
    Glow.Parent = MainFrame
    
    -- 标题
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, 0, 0.2, 0)
    Title.Position = UDim2.new(0, 0, 0.05, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "版本选择器"
    Title.TextColor3 = Color3.fromRGB(170, 170, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 28 -- 更大的字体
    Title.TextStrokeColor3 = Color3.new(0.1, 0.1, 0.2)
    Title.TextStrokeTransparency = 0.7
    Title.ZIndex = 4
    Title.Parent = MainFrame
    
    -- 旧版本按钮
    local OldButton = Instance.new("TextButton")
    OldButton.Name = "OldButton"
    OldButton.Size = UDim2.new(0.8, 0, 0.25, 0)
    OldButton.Position = UDim2.new(0.1, 0, 0.35, 0)
    OldButton.BackgroundColor3 = Color3.fromRGB(90, 90, 150)
    OldButton.Text = "使用旧版本"
    OldButton.Font = Enum.Font.GothamBold
    OldButton.TextSize = 20 -- 更大的按钮文字
    OldButton.TextColor3 = Color3.new(1, 1, 1)
    OldButton.AutoButtonColor = true
    OldButton.ZIndex = 4
    
    -- 按钮圆角
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0.3, 0)
    ButtonCorner.Parent = OldButton
    
    -- 按钮发光效果
    local ButtonGlow = Instance.new("UIStroke")
    ButtonGlow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    ButtonGlow.Color = Color3.new(0.2, 0.2, 0.3)
    ButtonGlow.Thickness = 3
    ButtonGlow.Transparency = 0.5
    ButtonGlow.Parent = OldButton
    
    -- 新版本按钮
    local NewButton = OldButton:Clone()
    NewButton.Name = "NewButton"
    NewButton.Position = UDim2.new(0.1, 0, 0.65, 0)
    NewButton.BackgroundColor3 = Color3.fromRGB(60, 150, 100)
    NewButton.Text = "使用新版本"
    
    MainFrame.Parent = ScreenGui
    OldButton.Parent = MainFrame
    NewButton.Parent = MainFrame
    
    -- 窗口渐入效果（带弹跳效果）
    MainFrame.Position = UDim2.new(0.5, 0, 0.45, 0) -- 初始位置稍高
    MainFrame.BackgroundTransparency = 1
    fadeIn(MainFrame, 0.7, {BackgroundTransparency = 0.15, Position = UDim2.new(0.5, 0, 0.5, 0)})
    
    -- 按钮鼠标悬停效果
    local function setupButtonHover(button)
        local originalColor = button.BackgroundColor3
        local originalScale = button.Size
        
        button.MouseEnter:Connect(function()
            button.UIStroke.Color = Color3.new(1, 1, 1)
            button.UIStroke.Thickness = 4
            
            local tween = TweenService:Create(button, TweenInfo.new(0.2), {
                BackgroundColor3 = originalColor:Lerp(Color3.new(1, 1, 1), 0.15),
                Size = UDim2.new(0.82, 0, 0.26, 0) -- 放大按钮
            })
            tween:Play()
        end)
        
        button.MouseLeave:Connect(function()
            button.UIStroke.Color = Color3.new(0.2, 0.2, 0.3)
            button.UIStroke.Thickness = 2
            
            local tween = TweenService:Create(button, TweenInfo.new(0.2), {
                BackgroundColor3 = originalColor,
                Size = originalScale
            })
            tween:Play()
        end)
        
        button.MouseButton1Down:Connect(function()
            local tween = TweenService:Create(button, TweenInfo.new(0.1), {
                BackgroundColor3 = originalColor:Lerp(Color3.new(0.5, 0.5, 0.5), 0.5),
                Size = UDim2.new(0.78, 0, 0.24, 0) -- 按钮按下时缩小
            })
            tween:Play()
        end)
    end
    
    setupButtonHover(OldButton)
    setupButtonHover(NewButton)
    
    -- 按钮功能
    OldButton.MouseButton1Click:Connect(function()
        fadeOut(MainFrame, 0.5, {BackgroundTransparency = 1, Position = UDim2.new(0.5, 0, 0.45, 0)})
        fadeOut(Background, 0.5, {BackgroundTransparency = 1})
        task.wait(0.5)
        loadScript("https://raw.githubusercontent.com/gZE66/lbls-gjB/refs/heads/main/gaoj")
        ScreenGui:Destroy()
    end)
    
    NewButton.MouseButton1Click:Connect(function()
        fadeOut(MainFrame, 0.5, {BackgroundTransparency = 1, Position = UDim2.new(0.5, 0, 0.45, 0)})
        fadeOut(Background, 0.5, {BackgroundTransparency = 1})
        task.wait(0.5)
        loadScript("https://raw.githubusercontent.com/gZE66/78/refs/heads/main/Gaon")
        ScreenGui:Destroy()
    end)
end

function loadScript(url)
    local success, result = pcall(function()
        -- 添加时间戳防止缓存
        url = url .. "?t=" .. os.time()
        
        -- 获取脚本内容
        local content = game:HttpGet(url, true)
        
        -- 安全执行脚本
        local scriptFunc, errorMsg = loadstring(content)
        if scriptFunc then
            scriptFunc()
        else
            warn("脚本编译错误: " .. tostring(errorMsg))
        end
    end)
    
    if not success then
        warn("脚本加载失败: " .. tostring(result))
    end
end
